<!DOCTYPE html>
<html lang="en">
<head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <meta http-equiv="X-UA-Compatible" content="ie=edge">
     <title>Index 2</title>
     <style>
    body {
    padding:0;
    margin:0;
     }
     .container {
     width:100%;
     height:100%;
     }
     .archive-map {
     width:100%;
     height:400px;
     }
     .nav {
     background:rgba(0, 0, 0, 0.5);
     width:100%;
     text-align:center;
     margin:0;
     padding-left:0;
     }
     .nav li {
     display:inline-block;
     }
     .nav li a {
     color:#fff;
     padding:10px;
     display:block;
     position:relative;
     z-index:100;
     }
     </style>
</head>
<body>
          <script
          src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAGI_jgIJQXJ-0dsWX-W8yindzXIcwO4fw&language=ee&dummy=dummy.js">
        </script>
     <!-- <script src="http://maps.googleapis.com/maps/api/js?sensor=false"></script> -->
     <!-- <ul class="nav">
          <li><a onclick="triggerClick(0)">location1</a>
      
          </li>
          <li><a onclick="triggerClick(1)">location2</a>
      
          </li>
          <li><a onclick="triggerClick(2)">location3</a>
      
          </li>
          <li><a onclick="triggerClick(3)">location4</a>
      
          </li>
      </ul> -->
      <div class="container">
          <div id="map" class="archive-map"></div>
      </div>
      <div id="app"></div>
      <div id="panel"></div>
<script>

     const
          jsonRegiones = "regiones.json"
          jsonLocales = "locales.json"
          mapCanvas = document.getElementById("map")
          panel = document.getElementById("panel")

          chileCords = {
                lng: -71.5429688,
                lat: -35.675148     
          }
          locations = [
               {
                    local:"uno",
                    comuna: "arica",
                    direccion: "Av. 18 de Septiembre 2501",
                    longitud: -72.9428900,
                    latitud: -41.4657400,
                    aperturaDiaHabil:"08:30",
                    cierreDiaHabil:"22:30",
                    aperturaSabado:"08:30",
                    cierreSabado:"22:30",
                    aperturaDomingo:"08:30",
                    cierreDomingo:"22:30",
                    aperturaViernes:"08:30",
                    cierreViernes:"22:30"
                },
                {
                    local:"dos",
                    comuna: "arica",
                    direccion: "Av. 18 de Septiembre 2501",
                    longitud:  -70.30033919999994,
                    latitud: -18.465690855302896,
                    aperturaDiaHabil:"08:30",
                    cierreDiaHabil:"22:30",
                    aperturaSabado:"08:30",
                    cierreSabado:"22:30",
                    aperturaDomingo:"08:30",
                    cierreDomingo:"22:30",
                    aperturaViernes:"08:30",
                    cierreViernes:"22:30"
                },
                {
                    local:"tres",
                    comuna: "arica",
                    direccion: "Av. 18 de Septiembre 2501",
                    longitud:  -71.2788485,
                    latitud: -29.9502974,
                    aperturaDiaHabil:"08:30",
                    cierreDiaHabil:"22:30",
                    aperturaSabado:"08:30",
                    cierreSabado:"22:30",
                    aperturaDomingo:"08:30",
                    cierreDomingo:"22:30",
                    aperturaViernes:"08:30",
                    cierreViernes:"22:30"
                },
                {
                    local:"cuatro",
                    comuna: "arica",
                    direccion: "Av. 18 de Septiembre 2501",
                    longitud:  -70.1492774,
                    latitud: -20.2138705,
                    aperturaDiaHabil:"08:30",
                    cierreDiaHabil:"22:30",
                    aperturaSabado:"08:30",
                    cierreSabado:"22:30",
                    aperturaDomingo:"08:30",
                    cierreDomingo:"22:30",
                    aperturaViernes:"08:30",
                    cierreViernes:"22:30"
                }
            ]

            let 
               markers = []
               infowindow = new google.maps.InfoWindow({
                    //  content: contentString,
                    maxWidth: 200
               })

               function addMarker (locales){
                    for (var i = 0; i < locales.length; i++) {
                    let 
                         contentString = `<div id="content"><h1> ${locales[i].local}</h1><p>Lorem ipsum dolor sit amet, vix mutat posse suscipit id, vel ea tantas omittam detraxit.</p></div>`
                         // console.log(contentString)
                                   
                         // marker = new google.maps.Marker({
                         //      position: {
                         //           lat: parseInt(locales.latitud),
                         //           lng: parseInt(locales.longitud)
                         //      },
                         // map: map,
                         // title: 'Click to zoom',
                         // id: [i],
                         // animation: google.maps.Animation.DROP
                         // })
                              let  marker = new google.maps.Marker({ 
                              position: {
                                   lat: parseInt(locales[i].latitud),
                                   lng: parseInt(locales[i].longitud)
                              },
                              map: map,
                              // type: "point",
                              // title: 'Click to zoom',
                              // id: [i],
                              animation: google.maps.Animation.DROP
                         })
                         // console.log(locales[i].latitud)
                         // Se agregan markers al array
                         // markers.push(marker)
                         // marker.setVisible(true)
                        

                    
                         google.maps.event.addListener(marker, 'click', (function (marker, i) {

                              return function () {
                                   infowindow.setContent(contentString);
                                   infowindow.open(map, marker);
                                   map.setZoom(9);
                                   map.setCenter(marker.getPosition());
                              }
                         })(marker, i))
                    }
          
                    // locales.map((local,i) => {
                    //      let 
                    //           contentString = `<div id="siteNotice">${local.local ? local.local : 'Tu ubicaci√≥n'}</div>`

                    //           marker = new google.maps.Marker({
                    //           position: {
                    //                lat: parseInt(local.latitud),
                    //                lng: parseInt(local.longitud)
                    //           },
                    //           map: map,
                    //           // type: "point",
                    //           // title: 'Click to zoom',
                    //           // id: [i],
                    //           animation: google.maps.Animation.DROP
                    //      })

                    //           function clickMarker() {
                    //                map.panTo(this.getPosition())
                    //                if (infowindow) {
                    //                infowindow.open(map, marker)
                    //                infowindow.setContent(contentString);
                    //                map.setZoom(8)
                    //                } else {
                    //                console.log('no hay infowindows')
                    //                }
                    //           }
                    //           google.maps.event.addListener(marker,'click', clickMarker)
                    //           //marker.addListener('click', clickMarker) 
                    //           markers.push(marker)
                    // })
     }

     function initMap() {
        map = new google.maps.Map(mapCanvas, {
          zoom: 8,
          center: chileCords,
          scrollwheel: false,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        })
        addMarker(locations)
        
     }

     initMap()
     
</script>
</body>
</html>